---
title: 典型的用户信息存储架构
date: 2019-04-25 21:30:39
categories:
- 程序设计
---

## 用户存储的使用场景
- 用户登录查询
- 用户信息查询
- 运营按照各种条件进行查询

## 分表设计
- 按照时间范围分表
  - 优点： 方便扩展
  - 缺点： 
    - 容易造成写热点（最新的一张表）
    - id必须保持全局递增
- 按照id取模分表
    - 优点: 查询写入均匀
    - 缺点： 难以扩展（要做好容量评估，适当冗余）


## 场景分析
- 登录场景
  - 按照手机号或者邮箱或者其他的一些数据查找id
  - 然后按照id取出用户信息
  - 这个时候就要简历映射表，并增加缓存

- 取用户信息
  - 直接用id取值即可

- 运营后台复杂条件查询
  - 建议引入外置索引(es)
  - 当创建用户时通过mq异步向es中同步数据
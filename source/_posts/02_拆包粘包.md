---
title: 粘包拆包
date: 2019-09-07 13:29:26
categories: 
- 网络
---

## 什么是粘包拆包
1. 一条数据在网络中因为大小或者某些发送效率的原因有可能会被拆分为多个数据包，这种情况就被称为拆包。
2. 在Nagle等算法的作用下，不同的数据的被拆分的两个数据包可能被放在一个包里面发送，这就叫粘包。

## UDP有这种问题吗
1. UDP在读取数据包的时候能明确知道哪里是数据包的结束，所以UDP会拆包，但是不用解决，因为接收方会阻塞直到接受到一条数据所有的数据包。
2. 因为UDP没有Nagle算法，不会合并数据包，所以不存在粘包问题。
   
## 如何解决TCP的粘包拆包问题
1. 解决这种问题的核心就是如何界定一条数据的开始和结束。
2. 解决方案根据具体场景的不同多种多样，简单的有根据数据固定大小分割的，说白了就是我读到一个固定大小的数据，我就认为这些数据包结束了，再接受的话就是下一条数据的数据包。
3. 现在Java业界主流的解决方案是使用Netty的`io.netty.handler.codec.LengthFieldBasedFrameDecoder`，此组件支持定义任意的长度，并且替你从网络流中截取满足条件的数据段，基本上Java世界中大多数知名网络中间件的网络通信都是用这个实现的。
   
